# 软件工程实训任务一：代码规范与标注

## 任务目的

* 理解软件代码规范的重要性
* 理解代码变化对软件质量带来的影响
* 掌握基于Git的个人代码版本维护方法
* 掌握MarkDown文件编写方法

## 任务内容

* 阅读、理解和标注样例代码
* 分析和学习代码质量特征、设计方法和编程风格
* 运用所学方法，对开源代码进行标注
* 对样例工程进行简单功能扩充和维护

## 示例代码的类图如下：

![](.\类图.svg)

其中Main类中有主函数，是项目的入口。

CommandWords类中的validCommands 数组存储了项目中所有的命令，并提供了判断一个字符串是否是有效命令的方法isCommand，以及打印所有命令的方法showAll。

Command类为项目中的命令类，其有两个成员变量，第一个成员变量CommandWord用于保存命令关键字，第二个成员变量用于保存命令后所跟的选项。

Parser类负责将用户输入的命令转化为Command对象。

Room类是该项目中表示场景时使用的类，其有两个成员变量，description用于保存该场景的描述信息，HashMap用于保存与该场景相邻的场景信息，key是direction，value是Room对象。

Game类是游戏的核心类，其中的parser用于读取用户输入的命令，currentRoom用于保存当前的场景信息，createRoom方法用于初始化游戏的场景信息，printWelcome方法的作用是打印一些欢迎提示信息，processCommand方法会判断具体是哪个命令然后调用相应的处理逻辑。printHelp，goRoom，quit方法分别用于处理help命令，go命令和quit命令。



## 扩充和维护样例工程

由于在Game类的processCommand()方法中，当用户输入的命令被辨认出来以后，有一系列的if语句用来分派程序到不同的地方去执行。从面向对象的设计原则来看，这种解决方案不太好，因为每当要加入一个新的命令时，就得在这一堆if语句中再加入一个if分支，最终会导致这个方法的代码膨胀得极其臃肿。

##### 我的解决方案是：

定义一个Command接口，在该接口中定义一个processCommand方法，项目中所有的命令类都需要实现该接口，而且项目中所有的命令类的命名必须遵循一定的规范：命令的首字母大写后面跟Command关键字 eg：go命令的命令类的命名：GoCommand。为了方便和管理项目中的命令我定义了一个Cmd注解，项目中所有的命令类都必须加上@Cmd注解，并在注解中标明该命令的名称。我在CommandWords类中写了一个静态代码块，当项目启动以来以后，会扫描项目中所有加了@Cmd注解的类将@Cmd注解的value值作为key，将该类的全类名作为value值加入到一个HashMap中。改进Parser类中的getCommand方法，在该方法中根据用户输入的命令关键字，从HashMap中获取该命令对应的命令类的全类名，再利用Java中的反射技术，根据类名创造出该类的对象并返回。此时Game类中的processCommand只需要调用Parser的getCommand方法返回的对象的接口方法processCommand便可以实现相应的功能而不必再做复杂的if判断。

##### 项目扩充：

1. 扩充了项目中的Room类：在项目中新建了一个Item类用于表示每个场景中的物品信息，向Room类中添加了一个ArrayList用于保存该场景中的物品信息，增加了一个addGoods方法用于向该场景添加物品。

2. 扩充了Room类：使一些房间具有特殊的功能，当玩家进入该房间后会被随机传送到下一个房间。

3. 向项目中添加了back命令：当玩家输入该命令的时候可以返回到上一个房间。

4. 向项目中添加了look命令：当玩家输入该命令后可以查看当前房间中的物品信息。

   

##### 标注：

给项目中的所有代码添加了符合JavaDoc 规范的代码注释